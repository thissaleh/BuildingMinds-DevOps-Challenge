# Use a lightweight Python base image for reduced size
FROM python:3.8-slim

# Set environment variables to avoid Python buffering and maximize compatibility
ENV PYTHONUNBUFFERED=1 \
    PYTHONIOENCODING=UTF-8

# Copy only the necessary files
COPY producer.py .

# Install dependencies in a single step to optimize layer caching
RUN python -m pip install --upgrade pip \
    && python -m pip install --no-cache-dir kafka-python kubernetes

# Set a non-root user for enhanced security
RUN useradd -m appuser
USER appuser

# Use a consistent working directory
WORKDIR /app

# Set the default command for the container
CMD ["python", "producer.py"]


